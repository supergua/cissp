# cissp

STRIDE方法


spoofing 欺骗——身份验证
tampering 篡改——完整性
repudation 否认——认可
information disclosure 信息泄露——机密性
denial of service 拒绝服务——可用性
evlation of privilege 权限提升——授权‘

smurf攻击  IP欺骗和icpm攻击

战略计划  5年
战术和操作计划 1年


数据管理员——数据保护任务：验证数据完整性、测试备份、管理安全策略
数据持有人——承担最终责任

SOC 1 财务
SOC 2 CIA，内部，报告
SOC 3 CIA,公开，报告，比2内容少

BCP 项目范围和规划阶段：对组织进行结构分析 、设立一个BCP计划小组、评估现有资源、分析法律和监管环境

降维分析：信任边界、数据流路径、输入点、特权操作、有关安全控制的细节


战略计划：稳定长期，组织目标，5年，作为计划编制的基准，讨论（未来的长期目标和愿景），包含风险评估

战术计划：中期计划，1年，规定和调度任务：项目、采购、雇佣、预算、维护、支持、系统开发等计划

操作计划：短期计划，基于战略和战术，非常详细，每月or每季度，资源分配、预算要求、人员分配、进度安排、循序渐进或实现措施，包括培训计划，系统部署计划和产品设计计划

TCSEC分类 美国

A---D  最高---最小  

A 已验证最高安全级别 B 强制性 C 自主性 D 最小化

D  最小化保护
C1 自主性保护
C2 受控访问保护
B1 标签式安全
B2 结构化保护
B3 安全域
A1 已验证保护


认证和鉴定：

认证：内部的安全验证，所在组织才相信
鉴定：第三方测试服务，所有人可信








ITSEC 欧洲

CC 通用准则

EAL 1 : 功能测试
EAL 2 : 结构测试

EAL 3 : 系统的测试和检查
EAL 4 : 系统的设计、测试和回顾

EAL 5 : 半正式设计和测试
EAL 6 : 半正式验证、设计和测试

EAL 7 : 正是验证、设计和测试



TCB （硬件、软件、控制相结合）


信息流模型:Biba、BLP

BLP：防止信息从高向低级别流动
Biba：防止信息从低向高级别流动



Bell-LaPadula 模型：（机密性）

简单安全属性：不能上读
*安全属性：不能下写
强*：同级别可写可读
自主安全属性：使用访问控制矩阵

受信任的主体不受*安全属性约束，可以下写



Biba 模型：（完整性）

简单完整性属性：不能下读
*完整性属性：不能上写
调用属性（Invocation property）:一个完整性级别低的主体不能从级别高的客体调用程序或服务

Clark-Wilson 模型：（完整性）

三元组：主体、程序、客体
原则：格式良好的事务处理、职责分离
实践应用:约束接口

解决：防止未授权主体对客体修改（Biba）、防止已授权主体对客体进行未授权的修改、保护内部和外部客体的一致性



Goguen-Meseguer 模型：（完整性）

非干涉模型，级域自动化理论和域的隔离


Sutherland 模型：（完整性）

基于状态机和信息流模型：定义一组系统状态的想法以及初始状态和状态转换


Graham-Denning 模型：

关注主体和客体在创建和删除时的安全性

TOC/TOU

数据清除



Nikto ： web应用程序和服务的扫描



安全评估：使用安全工具（自动、手动），彻底审查——威胁环境、当前未来面临风险、目标环境价值

安全审计：独立审计员

漏洞扫描：网络发现扫描、网络漏洞扫描、Web应用程序漏洞扫描

	网络发现扫描（nmap）：TCP syn、TCP连接、TCP ack、Xmas
	
	网络漏洞扫描（Nessus）：
	
	Web应用程序漏洞扫描：SQL注入、XSS、CSRF

代码审查：正式——Fagen检查：规划、概述、准备、检查、返工、后续行动

静态测试：不运行软件，分析源代码或编译的程序，缓冲区溢出

动态测试：web安全扫描、sql注入扫描

模糊测试：zzuf

接口测试：API，UI，物理接口

误用案例测试：

测试覆盖率分析：

代码覆盖率：单元测试（函数）




知其所需访问：安全许可

最小特权原则：依赖于每个人的工作描述


特权分离：

职责划分：SOX（萨班斯法案）
	职责分离控制矩阵，multi-XXXX


双人控制：减少共谋、欺骗可能性。eg. CFO+CEO批准关键决策

岗位轮换

强制休假



配置管理

基线：手动、自动化脚本，工具组策略

用镜像创建基线：GHOST、WDS


链路加密：用户信息、头、路由、地址等全加密，like HTTPS（SSL）,七层

端到端加密：只加密用户信息，like PEM（隐私增强邮件） 、PGP、SSH，三四层


IPSec （L3）：

AH，完整性，不可否认性，身份认证和访问控制，防重放
ESP，机密性、完整性，加密和有限的身份认证，防重放

传输模式：只加密esp，对等通信
隧道模式：加密ah和esp，网关间通信


ISAKMP：网络安全关联密钥管理协议，为IPSec提供安全支持，安全关联（SA）使用ISAKMP管理


密码学攻击：

分析攻击——降低算法复杂性

时间攻击——利用密码系统实现弱点，关注软件代码利用，设计错误、缺陷、编写加密系统所用的方法

统计攻击——利用密码系统统计弱点，试图发现驻留秒满血应用硬件or操作系统的漏洞。eg.无法生成随机数和浮点错误

蛮力攻击——尝试没中可能的、有效的密钥或者密码组合

频率分析和仅知密文攻击——分析频率，（ETOAIN字母在密文中最常见，可能是以为密码（其他字母最常见，可能是置换密码

已知明文攻击——like凯撒密码

选定密文攻击——可以发现密钥

选定明文攻击——

中间相遇攻击——2DES弃用

中间人攻击——会话劫持

生日攻击——冲突攻击、逆向散列匹配

重放攻击——拦截重放，防御：涉资和时间戳和过期时间


PGP：商用）RSA密钥交换+IDEA加解密+MD5 Hash
     免费) Diffie-Herman+CAST128位+SHA1 Hash

S/MIME：X.509,  RSA+AES or 3DES


数字签名标准（DSS）：DSA、RSA、ECDSA，美国必须使用SHA2


密钥长度：

HAMC	可变
MD2/4/5	128
SHA1	160
SHA256	256	512位分组
SHA512	512	1024位分组
HAVAL	可变128/160/192/224/256	

非对称：

椭圆密码系统（ECC）：RSA 1088位密钥 = ECC 160位密钥 = DSA 1024位

El Gamal：优于RSA，公开发布。密文=明文X2

RSA：专利产品，商业化



对称：

算法		分组大小	密钥大小
DES		64		56
3DES		64		112、168
AES		128		128、192、256
Rijndael	可变		128、192、256
Twofish		128		1-256
Blowfish	64		32-448
IDEA		64		128
RC5		32\64\128	0-2048
skipjack	64		80

AES：密钥128/192/256bit

Twofish：预白噪声化、后白噪声化

Rjindael：

Skipjack：

RC5：RSA专利，对称算法，分组可变，密钥0-2048

Blowfish：比IDEA和DES快，public free

IDEA；支持DES的4种模式，专利，非商业可用，PGP依赖IDEA

3DES：	1）K1K2K3三次加密,EEE3，
	2）K1K3加密K2解密，EDE3, 
	3）K1K2K1加密，EEE2,
	4）K1加密K2解密K1加密

1）2） 168bit
3）4） 112bit

数据加密标准DES：
5种模式：

ECB 电子代码本：安全性低，每次64bit分组

CBC 密码分组链接：使用IV，异或，错误传播

CFB 密码回馈模式：使用IV、密钥，反馈ciphertext

OFB 输出回馈模式：不传播错误，反馈keystream

CTR 计数模式：不传播错误



ILOVEYOU病毒：VBS等脚本 邮件伪装
梅丽莎病毒：Word 宏病毒伪装
Marzia病毒：复合病毒，文件感染+MBR感染
Code Red蠕虫：IIS
Stuxnet震网病毒：物理破坏，国家战争使用，西门子控制器


